import { ScanDetail } from "../tenable/types";
import { createScanVulnerabilityRelationships } from "./ScanVulnerabilityRelationshipConverter";

const scans: Array<Partial<ScanDetail>> = [
  {
    id: 1,
    vulnerabilities: [
      {
        count: 1,
        plugin_family: "Web Applications",
        plugin_id: 112526,
        plugin_name: "Missing 'X-XSS-Protection' Header",
        severity: 1,
      },
    ],
  },
];

describe("createScanVulnerabilityRelationships", () => {
  test("convert many", () => {
    const relationships = createScanVulnerabilityRelationships(
      scans as ScanDetail[],
    );
    expect(relationships).toEqual([
      {
        _class: "IDENTIFIED",
        _fromEntityKey: "tenable_scan_1",
        _key: "tenable_scan_1_identified_tenable_vulnerability_112526",
        _toEntityKey: "tenable_vulnerability_112526",
        _type: "tenable_scan_identified_vulnerability",
      },
    ]);
  });
});
