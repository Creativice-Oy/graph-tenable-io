import { EntityFromIntegration } from "@jupiterone/jupiter-managed-integration-sdk";

export const CONTAINER_VULNERABILITY_ENTITY_TYPE =
  "tenable_container_vulnerability";
export const CONTAINER_VULNERABILITY_ENTITY_CLASS = "Vulnerability";

export type ContainerVulnerabilityEntity =
  | MalwareVulnerabilityEntity
  | PotentiallyUnwantedProgramVulnerabilityEntity
  | FindingVulnerabilityEntity;

export interface MalwareVulnerabilityEntity extends EntityFromIntegration {
  infectedFile: string;
  fileTypeDescriptor: string;
  md5: string;
  sha256: string;
}

export interface PotentiallyUnwantedProgramVulnerabilityEntity
  extends EntityFromIntegration {
  file: string;
  md5: string;
  sha256: string;
}

export interface FindingVulnerabilityEntity extends EntityFromIntegration {
  referenceId: string;
  cve: string;
  publishedDate: string;
  modifiedDate: string;
  description: string;
  cvssScore: string;
  accessVector: string;
  accessComplexity: string;
  auth: string;
  availabilityImpact: string;
  confidentialityImpact: string;
  integrityImpact: string;
  cwe: string;
  remediation: string;
}
